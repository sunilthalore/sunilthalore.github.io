<!DOCTYPE html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>

<script>
	$(document).ready(function(){
		$("button").click(function(){
			var searchString = $("input").value
			console.log(searchString + "dddddddd")
		})
	})

</script>
</head>



<body>
	<h1>Enter city name</h1>
	<input type="text" name="search_string" id="searchBox">
	<button id="submitWeatherSearch" onclick="getWeather()">Get weather!</button>
	<p id="searchResult">Result placeholder</p>

	<script type="text/javascript">
	var accessToken = "YOURACCESSTOKEN";
	var baseUrl = "https://api.api.ai/v1/";
	var sessionID="mytesttempid";
	var v="20150910";
		function getWeather(){
			var searchString = document.getElementById("searchBox").value
			console.log(searchString)
			var xhttp = new XMLHttpRequest();
			
			xhttp.onreadystatechange = function() {
			 if (xhttp.readyState == XMLHttpRequest.DONE) {
			 	var responseTextResult = xhttp.responseText;
				console.log("logegged repsonse:" +responseTextResult);
				let responseJSON = JSON.parse(responseTextResult);
				let message = responseJSON.result.fulfillment.displayText;
				console.log(message)
				document.getElementById("searchResult").innerHTML = message;
			 }
			}

			url = baseUrl + "query?" + "v="+v+"&sessionId="+sessionID+"&lang=en"+"&query="+searchString;
			xhttp.open("GET",url,true);
			xhttp.setRequestHeader("Content-Type", "application/json; charset=utf-8");
			xhttp.setRequestHeader("Authorization", "Bearer " + open(".api-ai-key").read());
			xhttp.send();

			console.log("send reqeust")

		}
	</script>
</body>
</html>
